(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"7Z3z":function(o,e,t){"use strict";t.r(e),t.d(e,"UserProfileModule",function(){return U});var i=t("ofXK"),n=t("tyNb"),r=t("mrSG"),b=t("3Pt+"),c=t("vkgz"),s=t("SxV6"),l=t("fXoL"),u=t("vcGB"),a=t("qBIq"),d=t("gcOT"),m=t("2Vo4"),h=t("Vaw3"),f=t("UbJi");let O=(()=>{class o{constructor(o,e){this._fireStorage=o,this._angularAuth=e,this._urlPhotoSubject$=new m.a(null),this.urlPhoto$=this._urlPhotoSubject$.asObservable()}takePhoto(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield d.b.getPhoto({resultType:d.c.Uri,source:d.d.Camera,quality:100});return this.imageUrl=o.webPath,this.saveImage()})}saveImage(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield this._angularAuth.currentUser.then(o=>o.uid),e=Date.now(),t=yield this.readAsBlob(this.imageUrl),i=this._fireStorage.ref(`${e}${o}`);return yield i.put(t),yield i.getDownloadURL().toPromise()})}readAsBlob(o){return Object(r.b)(this,void 0,void 0,function*(){const e=yield fetch(o);return yield e.blob()})}}return o.\u0275fac=function(e){return new(e||o)(l.Sb(h.a),l.Sb(f.a))},o.\u0275prov=l.Hb({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var g=t("M7+f"),p=t("TEn/");function k(o,e){if(1&o&&(l.Ob(0,"ion-item"),l.Ob(1,"ion-label"),l.nc(2,"Offre"),l.Nb(),l.Ob(3,"ion-label"),l.nc(4),l.Nb(),l.Ob(5,"ion-label"),l.nc(6),l.Nb(),l.Mb(7,"ion-icon",15),l.Nb()),2&o){const o=e.$implicit;l.Bb(4),l.oc(null==o?null:o.offer),l.Bb(2),l.oc(null==o?null:o.contact)}}function N(o,e){if(1&o&&(l.Ob(0,"ion-select-option",16),l.nc(1),l.Nb()),2&o){const o=e.$implicit;l.dc("value",o.name),l.Bb(1),l.pc(" ",o.name," ")}}let v=(()=>{class o{constructor(o,e,t,i,n,r,b){this._userBookService=o,this._route=e,this._formBuilder=t,this._bookservice=i,this._cameraService=n,this._router=r,this._interestService=b}ngOnInit(){this.form=this._formBuilder.group({title:["",b.k.required],authors:["",b.k.required],publisher:["",b.k.required],image:[""],offer:["",b.k.required],category:["",b.k.required]}),this._route.paramMap.subscribe(o=>{const e=o.get("id");this._userBookService.getUserBookById(e),this._interestService.getListInterstsByBookId(e)}),this.subscription=this._userBookService.bookDetail$.pipe(Object(c.a)(o=>this.form.patchValue(o)),Object(c.a)(o=>this.imageUrl=null==o?void 0:o.image),Object(c.a)(o=>this._bookId=null==o?void 0:o.id)).subscribe(o=>this.selectedBook$=o),this._getCategories(),this._interestService.interest$.pipe(Object(c.a)(o=>console.log("interEdit: ",o))).subscribe(o=>this.interests=o)}_getCategories(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield this._bookservice.getCategories().pipe(Object(s.a)()).toPromise();this.categories=o})}takePhoto(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield this._cameraService.takePhoto();this.imageUrl=o})}onSubmit(){const o=Object.assign(Object.assign({},this.form.value),{id:this._bookId,image:this.imageUrl});this._bookservice.updateBook(o)}deleteBook(o){this._userBookService.deleteBook(o),this._router.navigate(["pages/user-profile"])}ngOnDestroy(){this.subscription.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(l.Lb(u.a),l.Lb(n.a),l.Lb(b.a),l.Lb(a.a),l.Lb(O),l.Lb(n.e),l.Lb(g.a))},o.\u0275cmp=l.Fb({type:o,selectors:[["app-book-edit-remove"]],decls:59,vars:10,consts:[["slot","start"],[1,"image",3,"src"],[1,"ion-justify-content-center"],[4,"ngFor","ngForOf"],[3,"formGroup","ngSubmit"],["expand","block",3,"click"],["position","stacked"],["formControlName","title","value","title"],["formControlName","authors"],["formControlName","publisher"],["formControlName","offer"],["formControlName","category","okText","Ok","cancelText","Cancel",3,"placeholder","value"],[3,"value",4,"ngFor","ngForOf"],["type","submit","expand","block",3,"disabled"],["color","danger","expand","block",3,"click"],["name","trash-outline"],[3,"value"]],template:function(o,e){1&o&&(l.Ob(0,"ion-header"),l.Ob(1,"ion-toolbar"),l.Ob(2,"ion-buttons",0),l.Mb(3,"ion-back-button"),l.Nb(),l.Ob(4,"ion-title"),l.nc(5,"\xc9diter / Supprimer"),l.Nb(),l.Nb(),l.Nb(),l.Ob(6,"ion-content"),l.Ob(7,"ion-card"),l.Ob(8,"ion-card-header"),l.Mb(9,"ion-img",1),l.Ob(10,"ion-grid"),l.Ob(11,"ion-row",2),l.Ob(12,"ion-card-title"),l.nc(13),l.Nb(),l.Nb(),l.Ob(14,"ion-row",2),l.Ob(15,"ion-card-subtitle"),l.nc(16),l.Nb(),l.Nb(),l.Ob(17,"ion-row",2),l.Ob(18,"ion-text"),l.nc(19," \xc9diteur: "),l.Nb(),l.nc(20),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(21,"ion-list"),l.mc(22,k,8,2,"ion-item",3),l.Nb(),l.Ob(23,"ion-card"),l.Ob(24,"form",4),l.Wb("ngSubmit",function(){return e.onSubmit()}),l.Ob(25,"ion-card-content"),l.Ob(26,"ion-item"),l.Ob(27,"ion-button",5),l.Wb("click",function(){return e.takePhoto()}),l.nc(28," Photo "),l.Nb(),l.Nb(),l.Nb(),l.Ob(29,"ion-card-content"),l.Ob(30,"ion-item"),l.Ob(31,"ion-label",6),l.nc(32,"Titre"),l.Nb(),l.Mb(33,"ion-input",7),l.Nb(),l.Nb(),l.Ob(34,"ion-card-content"),l.Ob(35,"ion-item"),l.Ob(36,"ion-label",6),l.nc(37,"Author"),l.Nb(),l.Mb(38,"ion-input",8),l.Nb(),l.Nb(),l.Ob(39,"ion-card-content"),l.Ob(40,"ion-item"),l.Ob(41,"ion-label",6),l.nc(42,"Edition"),l.Nb(),l.Mb(43,"ion-input",9),l.Nb(),l.Nb(),l.Ob(44,"ion-card-content"),l.Ob(45,"ion-item"),l.Ob(46,"ion-label",6),l.nc(47,"offre"),l.Nb(),l.Mb(48,"ion-input",10),l.Nb(),l.Nb(),l.Ob(49,"ion-card-content"),l.Ob(50,"ion-item"),l.Ob(51,"ion-label"),l.nc(52,"Categories"),l.Nb(),l.Ob(53,"ion-select",11),l.mc(54,N,2,2,"ion-select-option",12),l.Nb(),l.Nb(),l.Nb(),l.Ob(55,"ion-button",13),l.nc(56," Click me "),l.Nb(),l.Nb(),l.Ob(57,"ion-button",14),l.Wb("click",function(){return e.deleteBook(null==e.selectedBook$?null:e.selectedBook$.id)}),l.nc(58," Supprimer livre "),l.Nb(),l.Nb(),l.Nb()),2&o&&(l.Bb(9),l.dc("src",null==e.selectedBook$?null:e.selectedBook$.image),l.Bb(4),l.pc(" ",null==e.selectedBook$?null:e.selectedBook$.title," "),l.Bb(3),l.oc(null==e.selectedBook$?null:e.selectedBook$.authors),l.Bb(4),l.pc(" ",null==e.selectedBook$?null:e.selectedBook$.publisher," "),l.Bb(2),l.dc("ngForOf",e.interests),l.Bb(2),l.dc("formGroup",e.form),l.Bb(29),l.dc("placeholder",null==e.selectedBook$?null:e.selectedBook$.categoryId)("value",null==e.selectedBook$?null:e.selectedBook$.categoryId),l.Bb(1),l.dc("ngForOf",e.categories),l.Bb(1),l.dc("disabled",e.form.invalid))},directives:[p.o,p.L,p.f,p.b,p.c,p.K,p.m,p.g,p.i,p.q,p.n,p.w,p.k,p.j,p.H,p.u,i.j,b.l,b.h,b.c,p.h,p.s,p.e,p.t,p.r,p.Q,b.g,b.b,p.A,p.P,p.p,p.B],styles:[".image[_ngcontent-%COMP%]{height:200px}ion-icon[_ngcontent-%COMP%]{color:red}"]}),o})();var B=t("AytR"),_=t("JIr8"),y=t("tk/3");const S=B.a.apiBooksUrl;let j=(()=>{class o{constructor(o){this._http=o}searchApiBook(o){return Object(r.b)(this,void 0,void 0,function*(){return yield this._http.get(`${S}${o}`).pipe(Object(_.a)(o=>Object(r.b)(this,void 0,void 0,function*(){return console.log("error: ",o)}))).toPromise()})}}return o.\u0275fac=function(e){return new(e||o)(l.Sb(y.a))},o.\u0275prov=l.Hb({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function I(o,e){1&o&&(l.Ob(0,"ion-badge",10),l.Mb(1,"ion-icon",11),l.Nb())}const P=function(o){return["/pages/user-profile/user-book",o]};function L(o,e){if(1&o){const o=l.Pb();l.Ob(0,"ion-slide",4),l.Wb("click",function(){l.jc(o);const t=e.$implicit;return l.Yb().selectBook(t.id)}),l.Ob(1,"ion-grid",5),l.Ob(2,"ion-row",6),l.Mb(3,"img",7),l.Nb(),l.Ob(4,"ion-row",8),l.Ob(5,"ion-label"),l.nc(6),l.Nb(),l.mc(7,I,2,0,"ion-badge",9),l.Nb(),l.Nb(),l.Nb()}if(2&o){const o=e.$implicit;l.dc("routerLink",l.gc(4,P,o.id)),l.Bb(3),l.dc("src",o.image,l.kc),l.Bb(3),l.oc(o.title.substr(0,25)),l.Bb(1),l.dc("ngIf",o.interests>0)}}let C=(()=>{class o{constructor(o,e){this._userBooksService=o,this._router=e,this.slideOpts={slidesPerView:3,coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0}}}ngOnInit(){return Object(r.b)(this,void 0,void 0,function*(){yield this._userBooksService.getUserBooks(),this._userBooksService.userBooks$.subscribe(o=>this.userBooks$=o)})}selectBook(o){this._userBooksService.getUserBookById(o)}}return o.\u0275fac=function(e){return new(e||o)(l.Lb(u.a),l.Lb(n.e))},o.\u0275cmp=l.Fb({type:o,selectors:[["app-user-books"]],decls:7,vars:2,consts:[["color","primary"],[1,"block_list"],[3,"options"],[3,"routerLink","click",4,"ngFor","ngForOf"],[3,"routerLink","click"],["fixed",""],[1,"ion-justify-content-center"],["alt","test",1,"img_book",3,"src"],[1,"ion-justify-content-center","ion-margin-top"],["color","success",4,"ngIf"],["color","success"],["name","alert-sharp"]],template:function(o,e){1&o&&(l.Ob(0,"ion-content"),l.Ob(1,"ion-text",0),l.Ob(2,"h1"),l.nc(3,"Mes livres"),l.Nb(),l.Nb(),l.Ob(4,"div",1),l.Ob(5,"ion-slides",2),l.mc(6,L,8,6,"ion-slide",3),l.Nb(),l.Nb(),l.Nb()),2&o&&(l.Bb(5),l.dc("options",e.slideOpts),l.Bb(1),l.dc("ngForOf",e.userBooks$))},directives:[p.m,p.H,p.D,i.j,p.C,n.f,p.O,p.n,p.w,p.t,i.k,p.d,p.p],styles:["ion-content[_ngcontent-%COMP%]{height:100vh}.img_book[_ngcontent-%COMP%]{height:130px}.block_list[_ngcontent-%COMP%]{margin:30px 10px 10px}"]}),o})();const $=function(){return["/pages/book-detail"]};function w(o,e){if(1&o){const o=l.Pb();l.Ob(0,"ion-item",8),l.Wb("click",function(){l.jc(o);const t=e.$implicit;return l.Yb().seletedBook(t)}),l.Ob(1,"ion-thumbnail",9),l.Mb(2,"img",10),l.Nb(),l.Ob(3,"ion-label",11),l.Ob(4,"ion-text"),l.Ob(5,"h2"),l.Ob(6,"strong"),l.nc(7),l.Nb(),l.Nb(),l.Nb(),l.Ob(8,"ion-text"),l.Ob(9,"h5"),l.nc(10),l.Nb(),l.Nb(),l.Nb(),l.Nb()}if(2&o){const o=e.$implicit;l.Bb(2),l.dc("src",null!=o.volumeInfo.imageLinks&&o.volumeInfo.imageLinks.smallThumbnail?null==o.volumeInfo.imageLinks?null:o.volumeInfo.imageLinks.smallThumbnail:"../../../assets/book-cover-placeholder.jpg",l.kc),l.Bb(1),l.dc("routerLink",l.fc(4,$)),l.Bb(4),l.oc(o.volumeInfo.title),l.Bb(3),l.oc(o.volumeInfo.authors)}}function x(o,e){if(1&o&&(l.Ob(0,"ion-select-option",23),l.nc(1),l.Nb()),2&o){const o=e.$implicit;l.dc("value",o.name),l.Bb(1),l.pc(" ",o.name," ")}}function M(o,e){if(1&o){const o=l.Pb();l.Ob(0,"div"),l.Ob(1,"ion-grid",6),l.Ob(2,"ion-row"),l.Ob(3,"form",12),l.Wb("ngSubmit",function(){return l.jc(o),l.Yb().onSubmit()}),l.Ob(4,"ion-col",7),l.Ob(5,"ion-text",13),l.Ob(6,"h4"),l.nc(7,"Ajouter livre"),l.Nb(),l.Nb(),l.Nb(),l.Ob(8,"ion-col",7),l.Ob(9,"ion-item"),l.Ob(10,"ion-button",14),l.Wb("click",function(){return l.jc(o),l.Yb().takePhoto()}),l.nc(11," Photo "),l.Nb(),l.Nb(),l.Nb(),l.Ob(12,"ion-col",7),l.Ob(13,"ion-item"),l.Ob(14,"ion-label",15),l.nc(15,"Titre"),l.Nb(),l.Mb(16,"ion-input",16),l.Nb(),l.Nb(),l.Ob(17,"ion-col",7),l.Ob(18,"ion-item"),l.Ob(19,"ion-label",15),l.nc(20,"Author"),l.Nb(),l.Mb(21,"ion-input",17),l.Nb(),l.Nb(),l.Ob(22,"ion-col",7),l.Ob(23,"ion-item"),l.Ob(24,"ion-label",15),l.nc(25,"Editeur"),l.Nb(),l.Mb(26,"ion-input",18),l.Nb(),l.Nb(),l.Ob(27,"ion-col",7),l.Ob(28,"ion-item"),l.Ob(29,"ion-label",15),l.nc(30,"Offre"),l.Nb(),l.Mb(31,"ion-input",19),l.Nb(),l.Nb(),l.Ob(32,"ion-col",7),l.Ob(33,"ion-item"),l.Ob(34,"ion-label"),l.nc(35,"Categories"),l.Nb(),l.Ob(36,"ion-select",20),l.mc(37,x,2,2,"ion-select-option",21),l.Nb(),l.Nb(),l.Nb(),l.Ob(38,"ion-col",7),l.Ob(39,"ion-button",22),l.nc(40," Valider "),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb()}if(2&o){const o=l.Yb();l.Bb(3),l.dc("formGroup",o.form),l.Bb(34),l.dc("ngForOf",o.categoriesList)}}const F=[{path:"",component:(()=>{class o{constructor(o,e,t,i,n,r){this._apiService=o,this._router=e,this._bookService=t,this.cameraService=i,this._formBuilder=n,this._angularAuth=r,this.bookSelected={title:"",authors:"",image:"",publisher:""},this.toggleForm=!1}ngOnInit(){return Object(r.b)(this,void 0,void 0,function*(){this.form=this._formBuilder.group({userId:["",b.k.required],title:["",b.k.required],authors:["",b.k.required],categoryId:["",b.k.required],image:["",b.k.required],publisher:["",b.k.required],offer:["",b.k.required]}),this.categoriesList=yield this._bookService.getCategories().pipe(Object(s.a)()).toPromise()})}getApibooks(o){return Object(r.b)(this,void 0,void 0,function*(){const e=yield this._apiService.searchApiBook(o);this.booksList=e.items})}seletedBook(o){var e;this.bookSelected=Object.assign(Object.assign({},this.bookSelected),{title:o.volumeInfo.title,authors:Array.isArray(o.volumeInfo.authors)?o.volumeInfo.authors[0]:o.volumeInfo.authors,image:null===(e=o.volumeInfo.imageLinks)||void 0===e?void 0:e.smallThumbnail,publisher:o.volumeInfo.publisher}),this._router.navigate(["/pages/book-detail"],{queryParams:this.bookSelected})}toggleBookForm(){this.toggleForm=!this.toggleForm}takePhoto(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield this.cameraService.takePhoto();this.photoUrl=o})}onSubmit(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield this._angularAuth.currentUser.then(o=>o.uid),e=Object.assign(Object.assign({},this.form.value),{userId:o,image:this.photoUrl,interests:0,researched:!1});this._bookService.createBook(e),this.toggleForm=!1})}getEvent(o){this.booksList=[]}}return o.\u0275fac=function(e){return new(e||o)(l.Lb(j),l.Lb(n.e),l.Lb(a.a),l.Lb(O),l.Lb(b.a),l.Lb(f.a))},o.\u0275cmp=l.Fb({type:o,selectors:[["app-user-profile"]],decls:20,vars:2,consts:[["type","text",3,"ionClear"],["search",""],["color","primary","expand","block","fill","solid",3,"click"],[3,"click",4,"ngFor","ngForOf"],["color","primary","expand","block",3,"click"],[4,"ngIf"],["fixed",""],["size","12"],[3,"click"],["slot","start"],[3,"src"],[3,"routerLink"],[1,"formSubmit",3,"formGroup","ngSubmit"],["color","primary"],["expand","block",3,"click"],["position","stacked"],["formControlName","title"],["formControlName","authors"],["formControlName","publisher"],["formControlName","offer"],["formControlName","categoryId","okText","Ok","cancelText","Cancel"],[3,"value",4,"ngFor","ngForOf"],["expand","block","type","submit",1,"btn"],[3,"value"]],template:function(o,e){if(1&o){const o=l.Pb();l.Ob(0,"ion-header"),l.Ob(1,"ion-toolbar"),l.Ob(2,"ion-title"),l.nc(3,"Profile"),l.Nb(),l.Nb(),l.Nb(),l.Ob(4,"ion-content"),l.Ob(5,"p"),l.nc(6,"Cherchez votre livre ou ajouter vous m\xeame"),l.Nb(),l.Ob(7,"ion-searchbar",0,1),l.Wb("ionClear",function(o){return e.getEvent(o)}),l.Nb(),l.Ob(9,"ion-button",2),l.Wb("click",function(){l.jc(o);const t=l.ic(8);return e.getApibooks(t.value)}),l.nc(10,"Valider"),l.Nb(),l.Ob(11,"ion-list"),l.mc(12,w,11,5,"ion-item",3),l.Nb(),l.Ob(13,"ion-button",4),l.Wb("click",function(){return e.toggleBookForm()}),l.nc(14,"Enregister moi m\xeame"),l.Nb(),l.mc(15,M,41,2,"div",5),l.Ob(16,"ion-grid",6),l.Ob(17,"ion-row"),l.Ob(18,"ion-col",7),l.Mb(19,"app-user-books"),l.Nb(),l.Nb(),l.Nb(),l.Nb()}2&o&&(l.Bb(12),l.dc("ngForOf",e.booksList),l.Bb(3),l.dc("ngIf",e.toggleForm))},directives:[p.o,p.L,p.K,p.m,p.x,p.Q,p.e,p.u,i.j,i.k,p.n,p.w,p.l,C,p.s,p.J,p.t,n.f,p.O,p.H,b.l,b.h,b.c,p.r,b.g,b.b,p.A,p.P,p.B],styles:[".btn[_ngcontent-%COMP%]{height:40px;margin-top:15px}.btn[_ngcontent-%COMP%], .formSubmit[_ngcontent-%COMP%]{width:100%}"]}),o})()},{path:"user-book/:id",component:v}];let A=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=l.Jb({type:o}),o.\u0275inj=l.Ib({imports:[[n.h.forChild(F)],n.h]}),o})();var q=t("PCNd");let U=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=l.Jb({type:o}),o.\u0275inj=l.Ib({imports:[[i.c,A,p.M,q.a,b.i]]}),o})()}}]);