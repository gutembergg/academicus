(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{RKQH:function(e,t,o){"use strict";o.r(t),o.d(t,"BooksListModule",function(){return h});var s=o("ofXK"),i=o("tyNb"),r=o("lJxs"),c=o("fXoL"),n=o("qBIq"),a=o("TEn/");function b(e,t){if(1&e){const e=c.Pb();c.Ob(0,"li",2),c.Wb("click",function(){c.jc(e);const t=c.Yb();return t.selected(t.item)}),c.nc(1),c.Nb()}if(2&e){const e=t.$implicit;c.Bb(1),c.pc(" ",e.volumeInfo.title," ")}}function d(e,t){if(1&e&&(c.Ob(0,"li"),c.nc(1),c.Nb()),2&e){const e=t.$implicit;c.Bb(1),c.pc(" ",e.title," ")}}const l=[{path:"",component:(()=>{class e{constructor(e){this._firestore=e}ngOnInit(){this.newBook$=this._firestore.books$.pipe(Object(r.a)(e=>e))}selected(e){console.log("Event",e)}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(n.a))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-books-list"]],decls:9,vars:6,consts:[[3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(c.Ob(0,"ion-content"),c.Ob(1,"ul"),c.mc(2,b,2,1,"li",0),c.Zb(3,"async"),c.Nb(),c.Ob(4,"h3"),c.nc(5,"Firestore DB"),c.Nb(),c.Ob(6,"ul"),c.mc(7,d,2,1,"li",1),c.Zb(8,"async"),c.Nb(),c.Nb()),2&e&&(c.Bb(2),c.dc("ngForOf",c.ac(3,2,t.books$)),c.Bb(5),c.dc("ngForOf",c.ac(8,4,t.newBook$)))},directives:[a.m,s.j],pipes:[s.b],styles:[""]}),e})()}];let u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Jb({type:e}),e.\u0275inj=c.Ib({imports:[[i.h.forChild(l)],i.h]}),e})(),h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Jb({type:e}),e.\u0275inj=c.Ib({imports:[[s.c,u,a.M]]}),e})()},qBIq:function(e,t,o){"use strict";o.d(t,"a",function(){return b});var s=o("mrSG"),i=o("2Vo4"),r=o("lJxs"),c=o("vkgz"),n=o("fXoL"),a=o("I/3d");let b=(()=>{class e{constructor(e){this._firestore=e,this.booksSubject$=new i.a([]),this.books$=this.booksSubject$.asObservable(),this.categorySujet$=new i.a([]),this.booksBycategory$=this.categorySujet$.asObservable(),this._researchedBooks$=new i.a([]),this.researchedBooks$=this._researchedBooks$.asObservable(),this._subCategories$=new i.a([]),this.subCategories$=this._subCategories$.asObservable(),this._booksSubCategory$=new i.a([]),this.booksSubCategory$=this._booksSubCategory$.asObservable(),this.colections=this._firestore.collection("books",e=>e.where("researched","==",!1)),this.colections.stateChanges(["added","modified","removed"]).pipe(Object(r.a)(e=>e.map(e=>{const t=e.payload.doc.data(),o=e.type;return Object.assign(Object.assign({id:e.payload.doc.id},t),{type:o})}))).subscribe(e=>{const t=[...this.booksSubject$.value.filter(t=>!e.find(e=>e.id===t.id)),...e.filter(e=>"removed"!==e.type)].map(e=>(delete e.type,e));this.booksSubject$.next(t)}),this.categories$=this._firestore.collection("categories").valueChanges(),this.subCategoriesList=this._firestore.collection("subcategories").valueChanges({idField:"id"}),this._firestore.collection("books",e=>e.where("researched","==",!0)).stateChanges(["added","modified","removed"]).pipe(Object(r.a)(e=>e.map(e=>{const t=e.payload.doc.data(),o=e.type;return Object.assign(Object.assign({id:e.payload.doc.id},t),{type:o})}))).subscribe(e=>{const t=[...this._researchedBooks$.value.filter(t=>!e.find(e=>e.id===t.id)),...e.filter(e=>"removed"!==e.type)].map(e=>(delete e.type,e));return this._researchedBooks$.next(t),t})}createBook(e){this._firestore.collection("books").add(e).then(e=>{console.log("Document written with ID: ",e.id)}).catch(e=>{console.error("Error adding document: ",e)})}getBooksByCategory$(e){return this.getSubCategories(e.name),this.books$.pipe(Object(r.a)(t=>t.filter(t=>t.categoryId===e.name)),Object(c.a)(e=>this.categorySujet$.next(e)))}getCategories(){return this.categories$}getSubCategories$(){return this.subCategoriesList}getSubCategories(e){this._firestore.collection("subcategories",t=>t.where("parent","==",e)).stateChanges(["added"]).pipe(Object(r.a)(e=>e.map(e=>{const t=e.payload.doc.data();return Object.assign({id:e.payload.doc.id},t)}))).subscribe(e=>this._subCategories$.next(e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)))}_getBooksBySubCategory(e){return this.books$.pipe(Object(r.a)(t=>t.filter(t=>t.subcategory===e)),Object(c.a)(e=>this._booksSubCategory$.next(e)))}updateBook(e){var{id:t}=e,o=Object(s.f)(e,["id"]);this._firestore.collection("books").doc(t).update(o).then(e=>console.log("Success!!!")).catch(e=>console.log("error: ",e))}deleteBook(e){this._firestore.collection("books").doc(e).delete().then(e=>e).catch(e=>console.log("Error: ",e))}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(a.a))},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);