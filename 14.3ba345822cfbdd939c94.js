(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"q6+z":function(e,t,o){"use strict";o.r(t),o.d(t,"PagesModule",function(){return I});var s=o("ofXK"),n=o("tyNb"),i=o("mrSG"),r=o("vkgz"),a=o("fXoL"),c=o("UbJi"),l=o("vcGB"),b=o("TEn/");function d(e,t){1&e&&(a.Ob(0,"ion-badge",7),a.Mb(1,"ion-icon",8),a.Nb())}function h(e,t){if(1&e&&(a.Ob(0,"ion-tab-bar",1),a.Ob(1,"ion-tab-button",2),a.Mb(2,"ion-icon",3),a.Ob(3,"ion-label"),a.nc(4,"home"),a.Nb(),a.Nb(),a.Ob(5,"ion-tab-button",4),a.Mb(6,"ion-icon",5),a.Ob(7,"ion-label"),a.nc(8,"profile"),a.Nb(),a.mc(9,d,2,0,"ion-badge",6),a.Nb(),a.Nb()),2&e){const e=a.Yb();a.Bb(9),a.dc("ngIf",e.interestesBook||e.interestesBookResearched)}}let u=(()=>{class e{constructor(e,t){this._authService=e,this._userBookService=t}ngOnInit(){return Object(i.b)(this,void 0,void 0,function*(){this._authService.onAuthStateChanged(e=>Object(i.b)(this,void 0,void 0,function*(){this.user=e,e&&(yield this._userBookService.getUserBooks(),this._userBookService.bookInterest$.pipe(Object(r.a)(e=>console.log("Interest: ",e))).subscribe(e=>{this.interestesBook=e}),this._userBookService.getUserResearchedBooks().then(e=>this._userBookService.researchedBooks$.pipe(Object(r.a)(e=>e.map(e=>(e.interests>0&&(this.interestesBookResearched=!0),e)))).subscribe(e=>e)))}))})}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(c.a),a.Lb(l.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-pages"]],decls:2,vars:1,consts:[["color","academicus-green","slot","bottom",4,"ngIf"],["color","academicus-green","slot","bottom"],["tab","home"],["name","home"],["tab","user-profile"],["name","person-circle-outline"],["color","warning",4,"ngIf"],["color","warning"],["name","alert-sharp"]],template:function(e,t){1&e&&(a.Ob(0,"ion-tabs"),a.mc(1,h,10,1,"ion-tab-bar",0),a.Nb()),2&e&&(a.Bb(1),a.dc("ngIf",t.user))},directives:[b.G,s.k,b.E,b.F,b.p,b.t,b.d],styles:[".home[_ngcontent-%COMP%]{height:100%}img[_ngcontent-%COMP%]{width:200px;height:200px}ion-row[_ngcontent-%COMP%]{height:100%}"]}),e})();var p=o("LRne"),f=o("mCNh"),k=o("lJxs"),g=o("IzEk"),O=o("eIep");const m=Object(k.a)(e=>!!e);let v=(()=>{class e{constructor(e,t){this.router=e,this.auth=t,this.canActivate=(e,t)=>{const o=e.data.authGuardPipe||(()=>m);return this.auth.user.pipe(Object(g.a)(1),o(e,t),Object(k.a)(e=>"boolean"==typeof e?e:Array.isArray(e)?this.router.createUrlTree(e):this.router.parseUrl(e)))}}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(n.e),a.Sb(c.a))},e.\u0275prov=Object(a.Hb)({factory:function(){return new e(Object(a.Sb)(n.e),Object(a.Sb)(c.a))},token:e,providedIn:"any"}),e})();const _=e=>({canActivate:[v],data:{authGuardPipe:e}}),j=(Object(k.a)(e=>!!e&&!e.isAnonymous),Object(O.a)(e=>e?e.getIdTokenResult():Object(p.a)(null)));Object(k.a)(e=>!!e&&e.emailVerified),Object(f.a)(j,Object(k.a)(e=>e?e.claims:[]));const B=()=>{return e=["pages/login"],Object(f.a)(m,Object(k.a)(t=>t||e));var e},y=[{path:"",component:u,children:[{path:"home",loadChildren:()=>Promise.all([o.e(2),o.e(0),o.e(17)]).then(o.bind(null,"fOOd")).then(e=>e.HomeModule)},{path:"book-list",loadChildren:()=>o.e(13).then(o.bind(null,"RKQH")).then(e=>e.BooksListModule)},Object.assign(Object.assign({path:"book-detail"},_(B)),{loadChildren:()=>Promise.all([o.e(2),o.e(16)]).then(o.bind(null,"jWvB")).then(e=>e.BooksDetailModule)}),Object.assign(Object.assign({path:"user-profile"},_(B)),{loadChildren:()=>Promise.all([o.e(2),o.e(3),o.e(0),o.e(18)]).then(o.bind(null,"7Z3z")).then(e=>e.UserProfileModule)}),{path:"login",loadChildren:()=>Promise.all([o.e(3),o.e(15)]).then(o.bind(null,"P9on")).then(e=>e.AuthenticationModule)},{path:"",redirectTo:"home",pathMatch:"full"}]}];let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({imports:[[n.h.forChild(y)],n.h]}),e})(),I=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({imports:[[s.c,w,b.M]]}),e})()},vcGB:function(e,t,o){"use strict";o.d(t,"a",function(){return b});var s=o("mrSG"),n=o("2Vo4"),i=o("lJxs"),r=o("vkgz"),a=o("fXoL"),c=o("I/3d"),l=o("UbJi");let b=(()=>{class e{constructor(e,t){this._firestore=e,this._angularAuth=t,this._userBooks$=new n.a([]),this.userBooks$=this._userBooks$.asObservable(),this._bookDetail$=new n.a(null),this.bookDetail$=this._bookDetail$.asObservable(),this._bookInterest$=new n.a(!1),this.bookInterest$=this._bookInterest$.asObservable(),this._researchedBooks$=new n.a([]),this.researchedBooks$=this._researchedBooks$.asObservable()}getUserBooks(){return Object(s.b)(this,void 0,void 0,function*(){const e=yield this._angularAuth.currentUser.then(e=>e.uid);this._firestore.collection("books",t=>t.where("userId","==",`${e}`).where("researched","==",!1)).stateChanges(["added","modified","removed"]).pipe(Object(i.a)(e=>e.map(e=>{const t=e.payload.doc.data(),o=e.type;return Object.assign(Object.assign({id:e.payload.doc.id},t),{type:o})}))).subscribe(e=>{const t=[...this._userBooks$.value.filter(t=>!e.find(e=>e.id===t.id)),...e.filter(e=>"removed"!==e.type)].map(e=>(delete e.type,e));this._bookInterest$.next(!1),t.map(e=>{e.interests>0&&this._bookInterest$.next(!0)}),this._userBooks$.next(t)})})}getUserBookById(e){this._firestore.doc(`books/${e}`).valueChanges({idField:"id"}).subscribe(e=>this._bookDetail$.next(e))}deleteBook(e){this._firestore.collection("books").doc(e).delete().then(e=>console.log("delete Function")).catch(e=>console.log("Error: ",e)),this._firestore.collection("interest",t=>t.where("bookId","==",e)).valueChanges({idField:"id"}).pipe(Object(r.a)(e=>{e.map(e=>this._firestore.collection("interest").doc(e.id).delete().then(e=>console.log("Interet deleted!!")).catch(e=>console.log("error: ",e)))})).subscribe(e=>e)}getUserResearchedBooks(){return Object(s.b)(this,void 0,void 0,function*(){const e=yield this._angularAuth.currentUser.then(e=>e.uid);this._firestore.collection("books",t=>t.where("userId","==",e).where("researched","==",!0)).stateChanges(["added","removed","modified"]).pipe(Object(i.a)(e=>e.map(e=>{const t=e.payload.doc.data(),o=e.type;return Object.assign(Object.assign({id:e.payload.doc.id},t),{type:o})}))).subscribe(e=>{const t=[...this._researchedBooks$.value.filter(t=>!e.find(e=>e.id===t.id)),...e.filter(e=>"removed"!==e.type)].map(e=>(delete e.type,e));return this._researchedBooks$.next(t),t})})}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(c.a),a.Sb(l.a))},e.\u0275prov=a.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);