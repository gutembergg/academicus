(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"7Z3z":function(o,e,t){"use strict";t.r(e),t.d(e,"UserProfileModule",function(){return _});var i=t("ofXK"),n=t("tyNb"),r=t("mrSG"),c=t("3Pt+"),s=t("SxV6"),b=t("fXoL"),l=t("AytR"),a=t("JIr8"),u=t("tk/3");const h=l.a.apiBooksUrl;let d=(()=>{class o{constructor(o){this._http=o}searchApiBook(o){return Object(r.b)(this,void 0,void 0,function*(){return yield this._http.get(`${h}${o}`).pipe(Object(a.a)(o=>Object(r.b)(this,void 0,void 0,function*(){return console.log("error: ",o)}))).toPromise()})}}return o.\u0275fac=function(e){return new(e||o)(b.Sb(u.a))},o.\u0275prov=b.Hb({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var f=t("qBIq"),m=t("gcOT"),g=t("2Vo4"),p=t("Vaw3"),O=t("UbJi");let v=(()=>{class o{constructor(o,e){this._fireStorage=o,this._angularAuth=e,this._urlPhotoSubject$=new g.a(null),this.urlPhoto$=this._urlPhotoSubject$.asObservable()}takePhoto(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield m.b.getPhoto({resultType:m.c.Uri,source:m.d.Camera,quality:100});return this.imageUrl=o.webPath,this.saveImage()})}saveImage(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield this._angularAuth.currentUser.then(o=>o.uid),e=Date.now(),t=yield this.readAsBlob(this.imageUrl),i=this._fireStorage.ref(`${e}${o}`);yield i.put(t);const n=yield i.getDownloadURL().toPromise();return console.log("url: ",n),n})}readAsBlob(o){return Object(r.b)(this,void 0,void 0,function*(){const e=yield fetch(o);return yield e.blob()})}}return o.\u0275fac=function(e){return new(e||o)(b.Sb(p.a),b.Sb(O.a))},o.\u0275prov=b.Hb({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var k=t("TEn/");let N=(()=>{class o{constructor(){this.slideOpts={slidesPerView:3,coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0}}}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=b.Fb({type:o,selectors:[["app-user-books"]],decls:12,vars:1,consts:[["color","primary"],[3,"options"],["fixed",""],[1,"ion-justify-content-center"],["alt","test",1,"img_book"]],template:function(o,e){1&o&&(b.Ob(0,"ion-content"),b.Ob(1,"ion-text",0),b.Ob(2,"h1"),b.nc(3,"Mes livres"),b.Nb(),b.Nb(),b.Ob(4,"ion-slides",1),b.Ob(5,"ion-slide"),b.Ob(6,"ion-grid",2),b.Ob(7,"ion-row",3),b.Mb(8,"img",4),b.Nb(),b.Ob(9,"ion-row",3),b.Ob(10,"p"),b.nc(11,"Title Book"),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&o&&(b.Bb(4),b.dc("options",e.slideOpts))},directives:[k.l,k.G,k.C,k.B,k.m,k.v],styles:["ion-content[_ngcontent-%COMP%]{height:100vh}"]}),o})();const y=function(){return["/pages/book-detail"]};function j(o,e){if(1&o){const o=b.Pb();b.Ob(0,"ion-item",8),b.Wb("click",function(){b.jc(o);const t=e.$implicit;return b.Yb().seletedBook(t)}),b.Ob(1,"ion-thumbnail",9),b.Mb(2,"img",10),b.Nb(),b.Ob(3,"ion-label",11),b.Ob(4,"ion-text"),b.Ob(5,"h2"),b.Ob(6,"strong"),b.nc(7),b.Nb(),b.Nb(),b.Nb(),b.Ob(8,"ion-text"),b.Ob(9,"h5"),b.nc(10),b.Nb(),b.Nb(),b.Nb(),b.Nb()}if(2&o){const o=e.$implicit;b.Bb(2),b.dc("src",null!=o.volumeInfo.imageLinks&&o.volumeInfo.imageLinks.smallThumbnail?null==o.volumeInfo.imageLinks?null:o.volumeInfo.imageLinks.smallThumbnail:"../../../assets/book-cover-placeholder.jpg",b.kc),b.Bb(1),b.dc("routerLink",b.fc(4,y)),b.Bb(4),b.oc(o.volumeInfo.title),b.Bb(3),b.oc(o.volumeInfo.authors)}}function I(o,e){if(1&o&&(b.Ob(0,"ion-select-option",22),b.nc(1),b.Nb()),2&o){const o=e.$implicit;b.dc("value",o.name),b.Bb(1),b.pc(" ",o.name," ")}}function w(o,e){if(1&o){const o=b.Pb();b.Ob(0,"div"),b.Ob(1,"ion-grid",6),b.Ob(2,"ion-row"),b.Ob(3,"ion-col",7),b.Ob(4,"ion-text",12),b.Ob(5,"h4"),b.nc(6,"Ajouter livre"),b.Nb(),b.Nb(),b.Nb(),b.Ob(7,"ion-col",7),b.Ob(8,"ion-item"),b.Ob(9,"ion-label",13),b.nc(10,"Titre"),b.Nb(),b.Mb(11,"ion-input",null,14),b.Nb(),b.Ob(13,"ion-item"),b.Ob(14,"ion-label",13),b.nc(15,"Author"),b.Nb(),b.Mb(16,"ion-input",null,15),b.Nb(),b.Ob(18,"ion-item"),b.Ob(19,"ion-label",13),b.nc(20,"Editeur"),b.Nb(),b.Mb(21,"ion-input",null,16),b.Nb(),b.Ob(23,"ion-item"),b.Ob(24,"ion-button",17),b.Wb("click",function(){return b.jc(o),b.Yb().takePhoto()}),b.nc(25," Photo "),b.Nb(),b.Nb(),b.Ob(26,"ion-item"),b.Ob(27,"ion-label",13),b.nc(28,"Offre"),b.Nb(),b.Mb(29,"ion-input",null,18),b.Nb(),b.Ob(31,"ion-item"),b.Ob(32,"ion-label"),b.nc(33,"Categories"),b.Nb(),b.Ob(34,"ion-select",19),b.Wb("ionChange",function(e){return b.jc(o),b.Yb().selectCategory(e)}),b.mc(35,I,2,2,"ion-select-option",20),b.Nb(),b.Nb(),b.Ob(36,"ion-button",21),b.Wb("click",function(){b.jc(o);const e=b.ic(12),t=b.ic(17),i=b.ic(22),n=b.ic(30);return b.Yb().registerMySelfBook(e.value,t.value,i.value,n.value)}),b.nc(37," Valider "),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()}if(2&o){const o=b.Yb();b.Bb(35),b.dc("ngForOf",o.categoriesList)}}const B=[{path:"",component:(()=>{class o{constructor(o,e,t,i,n,r){this._apiService=o,this._router=e,this._bookService=t,this.cameraService=i,this._formBuilder=n,this._angularAuth=r,this.bookSelected={title:"",authors:"",image:"",publisher:""},this.toggleForm=!1}ngOnInit(){return Object(r.b)(this,void 0,void 0,function*(){this.form=this._formBuilder.group({userId:["",c.j.required],title:["",c.j.required],authors:["",c.j.required],category:[""],image:["",c.j.required],publisher:["",c.j.required],offer:["",c.j.required]}),this.categoriesList=yield this._bookService.getCategories().pipe(Object(s.a)()).toPromise()})}getApibooks(o){return Object(r.b)(this,void 0,void 0,function*(){const e=yield this._apiService.searchApiBook(o);this.booksList=e.items})}seletedBook(o){var e;this.bookSelected=Object.assign(Object.assign({},this.bookSelected),{title:o.volumeInfo.title,authors:Array.isArray(o.volumeInfo.authors)?o.volumeInfo.authors[0]:o.volumeInfo.authors,image:null===(e=o.volumeInfo.imageLinks)||void 0===e?void 0:e.smallThumbnail,publisher:o.volumeInfo.publisher}),this._bookService.set(this.bookSelected),this._router.navigate(["/pages/book-detail"])}toggleBookForm(){this.toggleForm=!this.toggleForm}takePhoto(){return Object(r.b)(this,void 0,void 0,function*(){const o=yield this.cameraService.takePhoto();console.log("imgUrl",o),this.photoUrl=o})}selectCategory(o){const{detail:{value:e}}=o;this.categorySeleted=e,console.log("event",e)}registerMySelfBook(o,e,t,i){return Object(r.b)(this,void 0,void 0,function*(){const n=yield this._angularAuth.currentUser.then(o=>o.uid),r=Object.assign(Object.assign({},this.book),{userId:n,title:o,author:e,image:this.photoUrl,publish:t,categoryId:this.categorySeleted,offer:i});this._bookService.createBook(r),this.toggleForm=!1})}}return o.\u0275fac=function(e){return new(e||o)(b.Lb(d),b.Lb(n.e),b.Lb(f.a),b.Lb(v),b.Lb(c.a),b.Lb(O.a))},o.\u0275cmp=b.Fb({type:o,selectors:[["app-user-profile"]],decls:20,vars:2,consts:[["type","text"],["search",""],["color","primary","expand","block","fill","solid",3,"click"],[3,"click",4,"ngFor","ngForOf"],["color","primary","expand","block",3,"click"],[4,"ngIf"],["fixed",""],["size","12"],[3,"click"],["slot","start"],[3,"src"],[3,"routerLink"],["color","primary"],["position","stacked"],["title",""],["author",""],["publisher",""],["expand","block","shape","round",3,"click"],["offer",""],["okText","Ok","cancelText","Cancel",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["expand","block",1,"btn",3,"click"],[3,"value"]],template:function(o,e){if(1&o){const o=b.Pb();b.Ob(0,"ion-header"),b.Ob(1,"ion-toolbar"),b.Ob(2,"ion-title"),b.nc(3,"Profile"),b.Nb(),b.Nb(),b.Nb(),b.Ob(4,"ion-content"),b.Ob(5,"p"),b.nc(6,"Cherchez votre livre ou ajouter vous m\xeame"),b.Nb(),b.Mb(7,"ion-searchbar",0,1),b.Ob(9,"ion-button",2),b.Wb("click",function(){b.jc(o);const t=b.ic(8);return e.getApibooks(t.value)}),b.nc(10,"Valider"),b.Nb(),b.Ob(11,"ion-list"),b.mc(12,j,11,5,"ion-item",3),b.Nb(),b.Ob(13,"ion-button",4),b.Wb("click",function(){return e.toggleBookForm()}),b.nc(14,"Enregister moi m\xeame"),b.Nb(),b.mc(15,w,38,1,"div",5),b.Ob(16,"ion-grid",6),b.Ob(17,"ion-row"),b.Ob(18,"ion-col",7),b.Mb(19,"app-user-books"),b.Nb(),b.Nb(),b.Nb(),b.Nb()}2&o&&(b.Bb(12),b.dc("ngForOf",e.booksList),b.Bb(3),b.dc("ngIf",e.toggleForm))},directives:[k.n,k.K,k.J,k.l,k.w,k.P,k.d,k.t,i.j,i.k,k.m,k.v,k.k,N,k.r,k.I,k.s,n.f,k.N,k.G,k.q,k.z,k.O,k.A],styles:[".btn[_ngcontent-%COMP%]{height:40px;width:100%;margin-top:15px}"]}),o})()}];let S=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=b.Jb({type:o}),o.\u0275inj=b.Ib({imports:[[n.h.forChild(B)],n.h]}),o})();var P=t("PCNd");let _=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=b.Jb({type:o}),o.\u0275inj=b.Ib({imports:[[i.c,S,k.L,P.a]]}),o})()}}]);